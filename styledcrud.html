<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>Blog Posts</title>
  </head>
  <body>
    <h1>Blog Posts</h1>
    <table>
      <tr>
        <th>Post Title</th>
        <th>Post Date</th>
        <th>Post summary</th>
        <th>Edit</th>
        <th>Delete</th>
      </tr>
      <!-- add new posts into this element -->
      <tbody id="posts"></tbody>
    </table>
    <hr />

    <button id="addpost">Add Post</button>

    <dialog id="postform">
      <form id="add-form">
        <label for="title">Post Title:</label>
        <input type="text" id="title" name="title" required />
        <br />

        <label for="date">Post Date:</label>
        <input type="date" id="date" name="date" required />
        <br />

        <label for="summary">Post summary:</label>
        <textarea type="text" id="summary" name="summary"> </textarea>
        <br />

        <button id="cancel" type="button">Cancel</button>
        <button id="save" type="button">Save</button>
      </form>
    </dialog>

    <script type="module">
      //NOTE: refreshPosts contains the edit and delete functions
      import { refreshPosts, addPost } from "./styledblog.js";

      let curr = localStorage.getItem("posts");
      if (curr !== null && JSON.parse(curr).length > 0) {
        refreshPosts();
      } else {
        let inputposts = [
          {
            id: 1,
            title: "POST NUM 1",
            date: "2023-02-25",
            summary: "THIS IS POST 1",
          },
          {
            id: 2,
            title: "POST NUM 2",
            date: "2023-02-26",
            summary: "THIS IS POST 2",
          },
          {
            id: 3,
            title: "POST NUM 3",
            date: "2023-02-27",
            summary: "THIS IS POST 3",
          },
          {
            id: 4,
            title: "POST NUM 4",
            date: "2023-02-28",
            summary: "THIS IS POST 4",
          },
          {
            id: 5,
            title: "POST NUM 5",
            date: "2023-03-01",
            summary: "THIS IS POST 5",
          },
        ];
        localStorage.setItem("posts", JSON.stringify(inputposts));
        refreshPosts();
      }

      //Add new posts
      document.getElementById("addpost").addEventListener("click", () => {
        addPost();
      });
    </script>
  </body>
</html>

